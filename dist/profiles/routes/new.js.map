{"version":3,"sources":["../../../profiles/routes/new.js"],"names":["passport","require","Joi","module","exports","req","res","next","schema","object","keys","email","string","password","regex","RegExp","birthdate","firstName","lastName","username","token","type","id","number","validate","body","error","value","details","context","key","status","send","end","authenticate","err","user","info","message","console","log","baseUrl","redirect"],"mappings":"AAAA;;AACA,IAAMA,WAAWC,QAAQ,kCAAR,CAAjB;AACA,IAAMC,MAAMD,QAAQ,KAAR,CAAZ;AACA;AACAE,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACvC,QAAMC,SAASN,IAAIO,MAAJ,GAAaC,IAAb,CAAkB;AAC7BC,eAAOT,IAAIU,MAAJ,GAAaD,KAAb,EADsB;AAE7BE,kBAAUX,IAAIU,MAAJ,GAAaE,KAAb;AACN;AACA;AACA,YAAIC,MAAJ,CAAW,qBAAX,CAHM,CAFmB;AAO7BC,mBAAWd,IAAIU,MAAJ,EAPkB;AAQ7BK,mBAAWf,IAAIU,MAAJ,EARkB;AAS7BM,kBAAUhB,IAAIU,MAAJ,EATmB;AAU7BO,kBAAUjB,IAAIU,MAAJ,GAAaQ,KAAb,EAVmB;AAW7BC,cAAMnB,IAAIU,MAAJ,EAXuB;AAY7BU,YAAIpB,IAAIqB,MAAJ;AAZyB,KAAlB,CAAf;;AADuC,wBAehBrB,IAAIsB,QAAJ,CAAanB,IAAIoB,IAAjB,EAAuBjB,MAAvB,CAfgB;AAAA,QAehCkB,KAfgC,iBAehCA,KAfgC;AAAA,QAezBC,KAfyB,iBAezBA,KAfyB;;AAgBvC,QAAID,KAAJ,EAAW;AACP,gBAAQA,MAAME,OAAN,CAAc,CAAd,EAAiBC,OAAjB,CAAyBC,GAAjC;AACI,iBAAK,OAAL;AACIxB,oBAAIyB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBN,2BAAO;AADU,iBAArB;AAGA;AACJ,iBAAK,UAAL;AACIpB,oBAAIyB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBN,2BAAO;AADU,iBAArB;AAGA;AACJ;AACIpB,oBAAIyB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB;AAZR;AAcH,KAfD,MAeO;AACHjC,iBAASkC,YAAT,CAAsB,cAAtB,EAAsC,UAAUC,GAAV,EAAeC,IAAf,EAAqBC,IAArB,EAA2B;AAC7D,gBAAIF,GAAJ,EAAS;AACL,uBAAO5B,KAAK4B,GAAL,CAAP;AACH;AACD,gBAAI,CAACC,IAAL,EAAW;AACP9B,oBAAIyB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACjBN,2BAAOW,KAAKC;AADK,iBAArB;AAGH,aAJD,MAIO;AACHC,wBAAQC,GAAR,CAAYnC,IAAIoC,OAAhB;AACAnC,oBAAIyB,MAAJ,CAAW,GAAX,EAAgBW,QAAhB,CAAyB,WAAzB;AACH;AACJ,SAZD,EAYGrC,GAZH,EAYQC,GAZR,EAYaC,IAZb;AAaH;AACJ,CA9CD","file":"new.js","sourcesContent":["\"use strict\";\nconst passport = require('../../Services/Passport/Passport');\nconst Joi = require('joi');\n//route used for creating a new user\nmodule.exports = function (req, res, next) {\n    const schema = Joi.object().keys({\n        email: Joi.string().email(),\n        password: Joi.string().regex(\n            //password must contain letters or numbers\n            //and be a minumum of 6 characters, maximum 30\n            new RegExp('^[a-zA-Z0-9]{6,30}$')\n        ),\n        birthdate: Joi.string(),\n        firstName: Joi.string(),\n        lastName: Joi.string(),\n        username: Joi.string().token(),\n        type: Joi.string(),\n        id: Joi.number()\n    });\n    const {error, value} = Joi.validate(req.body, schema);\n    if (error) {\n        switch (error.details[0].context.key) {\n            case 'email':\n                res.status(400).send({\n                    error: 'please provide valid email address'\n                });\n                break;\n            case 'password':\n                res.status(400).send({\n                    error: 'please provide a valid password'\n                });\n                break;\n            default:\n                res.status(400).end();\n        }\n    } else {\n        passport.authenticate('local-signup', function (err, user, info) {\n            if (err) {\n                return next(err);\n            }\n            if (!user) {\n                res.status(401).send({\n                    error: info.message\n                });\n            } else {\n                console.log(req.baseUrl);\n                res.status(200).redirect('/profiles');\n            }\n        })(req, res, next);\n    }\n};"]}