{"version":3,"sources":["../../../reviews/Controllers/ReviewController.js"],"names":["dbmain","require","module","exports","index","req","res","query","params","reviewId","undefined","id","barberId","BarberId","userId","UserId","barbershopId","BarberShopId","haircutId","HaircutId","body","getComments","Comment","$ne","getLikes","Like","getRatings","Rating","Review","model","findAll","where","limit","then","send","reviews","err","status","error","post","Haircut","Barber","Barbershop","belongsTo","like","create","price","duration","parseInt","comment","parseFloat","rating","review"],"mappings":"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","file":"ReviewController.js","sourcesContent":["const dbmain = require('../../config/DB/DBmain');\n\nmodule.exports =  {\n    async index (req, res) {\n        let query = {};\n        if(!(req.params.reviewId === undefined)){\n            query.id = req.params.reviewId;\n        }\n        if(!(req.params.barberId === undefined)){\n            query.BarberId = req.params.barberId;\n        }\n        if(!(req.params.userId === undefined)){\n            query.UserId = req.params.userId;\n        }\n        if(!(req.params.barbershopId === undefined)){\n            query.BarberShopId = req.params.barbershopId;\n        }\n        if(!(req.params.haircutId === undefined)){\n            query.HaircutId = req.params.userId;\n        }\n        if(req.body.getComments){query.Comment = { $ne: null }}\n        if(req.body.getLikes){query.Like = { $ne: null }}\n        if(req.body.getRatings){query.Rating = { $ne: null }}\n        let Review = dbmain.model(\"Review\");\n        try {\n            Review.findAll({\n                where: query,\n                limit: 20\n            }).then(reviews => {\n                res.send(reviews)\n            });\n        } catch(err) {\n            res.status(500).send({\n                error: 'An error has occurred trying to fetch songs' + err\n            })\n        }\n    },\n\n    async post (req, res) {\n        let Haircut = dbmain.model(\"Haircut\");\n        let Barber = dbmain.model('Barber');\n        let Barbershop = dbmain.model('BarberShop');\n        let Review = dbmain.model(\"Review\");\n\n        Review.belongsTo(Barbershop);\n        Review.belongsTo(Haircut);\n        Review.belongsTo(Barber);\n\n        let like = null;\n        if(req.body.like){\n            like = true;\n        }\n        try {\n            Review.create({\n                id: req.body.id,\n                price: req.body.price,\n                duration: req.body.duration,\n                HaircutId: parseInt(req.params.haircutId) || null,\n                BarberId: parseInt(req.params.barberId) || null,\n                BarberShopId: parseInt(req.params.barberId) || null,\n                Like: like,\n                Comment: req.body.comment || null,\n                Rating: parseFloat(req.body.rating) || null,\n            })\n                .then(review => {\n                    res.send(review)\n                })\n        } catch(err) {\n            res.status(500).send({\n                error: 'An error has occurred trying to create haircut' + err\n            })\n        }\n    }\n};"]}