{"version":3,"sources":["../../../haircuts/Controllers/HaircutController.js"],"names":["dbmain","require","module","exports","index","req","res","query","params","barberId","undefined","BarberId","userId","UserId","Haircut","model","findAll","where","limit","then","send","haircuts","err","status","error","post","User","Barber","Hairtype","belongsTo","create","id","body","price","duration","parseInt","haircut"],"mappings":"AAAA;;;;AACA,IAAMA,SAASC,QAAQ,wBAAR,CAAf;;AAEAC,OAAOC,OAAP,GAAiB;AACPC,SADO;AAAA,4FACAC,GADA,EACKC,GADL;AAAA;AAAA;AAAA;AAAA;AAAA;AAELC,iCAFK,GAEG,EAFH;;AAGT,gCAAG,EAAEF,IAAIG,MAAJ,CAAWC,QAAX,KAAwBC,SAA1B,CAAH,EAAwC;AACpCH,sCAAMI,QAAN,GAAiBN,IAAIG,MAAJ,CAAWC,QAA5B;AACH;AACD,gCAAG,EAAEJ,IAAIG,MAAJ,CAAWI,MAAX,KAAsBF,SAAxB,CAAH,EAAsC;AAClCH,sCAAMM,MAAN,GAAeR,IAAIG,MAAJ,CAAWI,MAA1B;AACH;AACGE,mCATK,GASKd,OAAOe,KAAP,CAAa,SAAb,CATL;;AAUT,gCAAI;AACAD,wCAAQE,OAAR,CAAgB;AACZC,2CAAOV,KADK;AAEZW,2CAAO;AAFK,iCAAhB,EAGGC,IAHH,CAGQ,oBAAY;AAChBb,wCAAIc,IAAJ,CAASC,QAAT;AACH,iCALD;AAMH,6BAPD,CAOE,OAAMC,GAAN,EAAW;AACThB,oCAAIiB,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;AACjBI,2CAAO,gDAAgDF;AADtC,iCAArB;AAGH;;AArBQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAuBPG,QAvBO;AAAA,8FAuBDpB,GAvBC,EAuBIC,GAvBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAwBLQ,mCAxBK,GAwBKd,OAAOe,KAAP,CAAa,SAAb,CAxBL;AAyBLW,gCAzBK,GAyBE1B,OAAOe,KAAP,CAAa,MAAb,CAzBF;AA0BLY,kCA1BK,GA0BI3B,OAAOe,KAAP,CAAa,QAAb,CA1BJ;AA2BLa,oCA3BK,GA2BM5B,OAAOe,KAAP,CAAa,UAAb,CA3BN;;AA4BTD,oCAAQe,SAAR,CAAkBD,QAAlB;AACAd,oCAAQe,SAAR,CAAkBH,IAAlB;AACAZ,oCAAQe,SAAR,CAAkBF,MAAlB;AACA,gCAAI;AACAb,wCAAQgB,MAAR,CAAe;AACXC,wCAAI1B,IAAI2B,IAAJ,CAASD,EADF;AAEXE,2CAAO5B,IAAI2B,IAAJ,CAASC,KAFL;AAGXC,8CAAU7B,IAAI2B,IAAJ,CAASE,QAHR;AAIXrB,4CAAQsB,SAAS9B,IAAIG,MAAJ,CAAWI,MAApB,KAA+B,IAJ5B;AAKXD,8CAAUwB,SAAS9B,IAAIG,MAAJ,CAAWC,QAApB,KAAiC;AALhC,iCAAf,EAOKU,IAPL,CAOU,mBAAW;AACbb,wCAAIc,IAAJ,CAASgB,OAAT;AACH,iCATL;AAUH,6BAXD,CAWE,OAAMd,GAAN,EAAW;AACThB,oCAAIiB,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;AACjBI,2CAAO,mDAAmDF;AADzC,iCAArB;AAGH;;AA9CQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,CAAjB","file":"HaircutController.js","sourcesContent":["'use strict';\nconst dbmain = require('../../config/DB/DBmain');\n\nmodule.exports = {\n    async index (req, res) {\n        let query = {};\n        if(!(req.params.barberId === undefined)){\n            query.BarberId = req.params.barberId;\n        }\n        if(!(req.params.userId === undefined)){\n            query.UserId = req.params.userId;\n        }\n        let Haircut = dbmain.model(\"Haircut\");\n        try {\n            Haircut.findAll({\n                where: query,\n                limit: 20\n            }).then(haircuts => {\n                res.send(haircuts)\n            });\n        } catch(err) {\n            res.status(500).send({\n                error: 'An error has occurred trying to fetch songs' + err\n            })\n        }\n    },\n    async post (req, res) {\n        let Haircut = dbmain.model(\"Haircut\");\n        let User = dbmain.model(\"User\");\n        let Barber = dbmain.model('Barber');\n        let Hairtype = dbmain.model('Hairtype');\n        Haircut.belongsTo(Hairtype);\n        Haircut.belongsTo(User);\n        Haircut.belongsTo(Barber);\n        try {\n            Haircut.create({\n                id: req.body.id,\n                price: req.body.price,\n                duration: req.body.duration,\n                UserId: parseInt(req.params.userId) || null,\n                BarberId: parseInt(req.params.barberId) || null\n            })\n                .then(haircut => {\n                    res.send(haircut)\n                })\n        } catch(err) {\n            res.status(500).send({\n                error: 'An error has occurred trying to create haircut' + err\n            })\n        }\n    }\n};"]}